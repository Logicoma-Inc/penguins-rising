<!DOCTYPE html>
<html>
<!--manifest="mystaticdir/Offline.appcache"-->
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Penguins Rising</title>
    <meta name="description" content="Penguins Rising - Zombie Survial Game" />
    <link rel="stylesheet" type="text/css" href="styles/index.css">
    <style>
        @media screen and (max-width:400px) {
            .right {
                display:none;
            }
        }
    </style>
</head>
<body>
    <div id="dialog-modal">
        <h2>Penguins Rising <i>Beta</i></h2>
        <div id="welcome">
            <div class="startMenu buttons" id="message"></div>
        </div>
        <button id="playGame" class="action redbtn" onclick="welcome.startGame()"><span class="label" id="Gamer">Loading</span></button>
    </div>
    <div id="game">
        <div id="rightSide"></div>
            <canvas id="window">Sorry but Canvas is not Supported</canvas>
    </div>
    <div id="GameData">
        <audio id="Bleed">            
            <source src="content/Bleed.ogg" type="audio/ogg">
            <source src="content/Bleed.mp3" type="audio/mpeg">
            Your browser does not support this audio format.
        </audio>
        <audio id="gunshot">
            <source src="content/gunshot.wav" type="audio/wav">
            <source src="content/gunshot.mp3" type="audio/mpeg">
            Your browser does not support the audio format.
        </audio>
        <audio autoplay loop>
            <source src="content/ArcticWind.wav" type="audio/wav"> 
            <source src="content/ArcticWind.ogg" type="audio/ogg">          
            <source src="mp3/ArcticWind.mp3" type="audio/mpeg">
        </audio>
    </div>
    <footer>
        <div class="left">
            <div class="g-plus" data-action="share" data-href="http://www.penguinsontherise.appspot.com"></div>
        </div>
        <div class="right">
            <b>Checkout Updates</b>
            <iframe id="github" src="http://ghbtns.com/github-btn.html?user=fassetar&repo=Penguins-Rising&type=watch" allowtransparency="true" frameborder="0" scrolling="0" width="62" height="20"></iframe>
        </div>
    </footer>
    <noscript>
        Well this is kinda weird... You don't have Javascript?
    </noscript>
    <script async src="js/login.js"></script>
    <script async src="js/achievementManager.js"></script>
    <script async src="js/leaderboardManager.js"></script>
    <script type="text/javascript" src="js/snowstorm-min.js"></script>
    <script async type="text/javascript" src="https://apis.google.com/js/client:plusone.js?onload=apisLoaded"></script>
    <script>
        (function () {
            var apisLoaded = function () {
                login.init();
            };
            snowStorm.flakesMaxActive = 96;

            function AssetManager() {
                this.successCount = 0;
                this.errorCount = 0;
                this.downloadQueue = [];
                this.cache = {};
            }
            AssetManager.prototype.queueDownload = function (path) {
                this.downloadQueue.push(path);
            }
            AssetManager.prototype.downloadAll = function (downloadCallback) {
                if (this.downloadQueue.length === 0) {
                    downloadCallback();
                }
                for (var i = 0; i < this.downloadQueue.length; i++) {
                    var path = this.downloadQueue[i];
                    var img = new Image();
                    var that = this;
                    img.addEventListener("load", function () {
                        console.log(this.src + ' is loaded');
                        that.successCount += 1;
                        if (that.isDone()) {
                            downloadCallback();
                        }
                    }, false);
                    img.addEventListener("error", function () {
                        that.errorCount += 1;
                        if (that.isDone()) {
                            downloadCallback();
                        }
                    }, false);
                    img.src = path;
                    this.cache[path] = img;
                }
            }
            AssetManager.prototype.isDone = function () {
                return (this.downloadQueue.length == this.successCount + this.errorCount);
            }
            AssetManager.prototype.getAsset = function (path) {
                return this.cache[path];
            }
            var ASSET_MANAGER = new AssetManager();
            ASSET_MANAGER.queueDownload('images/landscape.png');
            ASSET_MANAGER.queueDownload('images/landscape.png');
            ASSET_MANAGER.downloadAll(function(){});
            if (ASSET_MANAGER.isDone)
            {
                document.getElementById("Gamer").innerHTML = "Play Game";
            }
      })();
    </script>
    <script async src="js/game.js"></script>
</body>
</html>
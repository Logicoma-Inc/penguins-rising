/*!
 * Penguins Rising
 * @author Anthony Fassett
 * @version 2.0.0
 * Copyright 2015.
 */
"use script";function Animator(){var e=this;writeDebug("Animator()"),this.tweens=[],this.tweens["default"]=[1,2,3,4,5,6,7,8,9,10,9,8,7,6,5,4,3,2,1],this.tweens.blast=[12,12,11,10,10,9,8,7,6,5,4,3,2,1],this.tweens.fade=[10,10,10,10,10,10,10,10,10,10],this.queue=[],this.queue.IDs=[],this.active=!1,this.timer=null,this.createTween=function(t,a,n){n=n||"default";for(var o=[t],i=t,s=a-t,r=e.tweens[n].length,l=0;r>l;l++)i+=.01*s*e.tweens[n][l],o[l]={},o[l].data=i,o[l].event=null;return o},this.enqueue=function(t,a,n){var o;a||writeDebug("animator.enqueue(): missing fMethod"),e.queue.IDs[t.oID]===void 0?(o=e.queue.length,e.queue.IDs[t.oID]=o,e.queue[o]=t):(o=e.queue.IDs[t.oID],e.queue[o].active=!0,e.queue[o].frame=0),t.active=!0,e.queue[o]._method=a,e.queue[o]._oncomplete=n?n:null},this.animate=function(){for(var t=0,a=e.queue.length;a--;)e.queue[a].active&&(e.queue[a]._method(),t++);0===t&&e.timer&&e.stop()},this.start=function(){return e.timer||e.active?!1:(e.active=!0,e.timer=setInterval(e.animate,fc.intervalRate),void 0)},this.stop=function(){clearInterval(e.timer),e.timer=null,e.active=!1,e.queue=[],e.queue.IDs=[]}}function FireworksController(){var e=this;this.intervalRate=20,this.DEBUG=!0,this.oFW=null,this.isIE=!!navigator.userAgent.match(/msie/i),this.isOpera=!!navigator.userAgent.match(/opera/i),this.isOpera&&(this.isIE=!1),this.fireworks=[],this.animator=null,this.gOID=0,this.particleTypes=6,this.particleXY=10,this.tweenFade=[100,90,80,70,60,50,40,30,20,10,0],this.isSafari=!!navigator.appVersion.match(/webkit/i),this.canvasX=null,this.canvasY=null,this.screenY=null,e.scrollY=null,e.getWindowCoords=function(){e.canvasX=document.documentElement.clientWidth||document.body.clientWidth||document.body.scrollWidth,e.canvasY=document.documentElement.clientHeight||document.body.clientHeight||document.body.scrollHeight,e.screenY=e.canvasY,e.scrollY=parseInt(window.scrollY||document.documentElement.scrollTop||document.body.scrollTop,10),e.canvasY+=e.scrollY},this.getWindowCoordsAlt=function(){e.canvasX=window.innerWidth-16,e.canvasY=window.innerHeight,e.screenY=e.canvasY,e.scrollY=parseInt(window.scrollY||document.documentElement.scrollTop||document.body.scrollTop,10),e.canvasY+=e.scrollY},this.getPanX=function(t){t=parseInt(t,10);var a=t/e.canvasX;return.4>a?a*=-1:a>=.4&&.6>=a&&(a=.5),a=parseInt(100*a,10)},this.isEmpty=function(e){return e===void 0||null===e&&0!==e||""===e&&0!==e||"null"===e},this.init=function(){e.oFW=document.getElementById("fw"),e.oFP=document.getElementById("fp"),"undefined"!=typeof enableDebugMode&&(e.DEBUG||(""+window.location).toLowerCase().indexOf("debug")>=0)&&enableDebugMode(),e.getWindowCoords(),e.animator=new Animator},this.destructor=function(){for(var t=e.fireworks.length;t--;)e.fireworks[t]=null;e.fireworks=null},(this.isSafari||this.isOpera)&&(this.getWindowCoords=this.getWindowCoordsAlt)}function Firework(e,t,a,n,o,i,s,r,l,c,d){var m=this;this.oID="fp"+fc.gOID++;for(var u="",h=0;arguments.length-1>h;h++)u+=arguments[h]+",";u+=arguments[h],writeDebug("firework("+u+")"),this.oC=e,this.o=fc.oFW.cloneNode(fc.isIE?!1:!0),this.particles=[],this.vX=-1,this.vY=-4,this.x=t,this.y=a,this.allowRandom=c,this.obeyBoundaries=d,this.frame=0,this.tween=[],this.active=!1,this.moveTo=function(e,t){m.o.style.left=e+"px",m.o.style.top=t+"px",m.x=e,m.y=t},this.slideTo=function(e,t){m.tween=[fc.animator.createTween(m.x,e,"blast"),fc.animator.createTween(m.y,t,"blast")],fc.animator.enqueue(m,m.animate,m.aniExplode)},this.aniExplode=function(){m.o.style.background="none",m.o.style.border="none";for(var e=m.particles.length;--e;)m.particles[e].o.style.display="block",fc.animator.enqueue(m.particles[e],m.particles[e].animate);m.particles[e].o.style.display="block",fc.animator.enqueue(m.particles[e],m.particles[e].animate,m.beginFade);var t="boom"+parseInt(8*Math.random(),10);soundManager.ok()&&soundManager.play(t,{pan:fc.getPanX(m.x)})},this.beginFade=function(){m.tween=fc.animator.createTween(1,0,"fade"),fc.animator.enqueue(m,m.aniFade,m.destructor)},this.aniFade=function(){for(var e=m.particles.length;e--;)m.particles[e].moveRel(),m.particles[e].nextState(),m.particles[e].setOpacity(fc.tweenFade[m.frame]);return m.frame++>=m.tween.length?(m.active=!1,m.frame=0,m._oncomplete&&m._oncomplete(),m._oncomplete=null,!1):!0},this.destructor=function(){writeDebug("firework.destructor()");for(var e=m.particles.length;e--;)m.particles[e].destructor(),m.particles[e]=null;m.particles=null,m.oC.removeChild(m.o),m.o=null,m.oC=null},this.animate=function(){return m.moveTo(m.tween[0][m.frame].data,m.tween[1][m.frame].data,"burst"),m.frame++>=m.tween[0].length-1?(m.active=!1,m.frame=0,m._oncomplete&&m._oncomplete(),m._oncomplete=null,!1):!0},this.createBurst=function(e,t,a,i){writeDebug("firework.createBurst("+e+","+t+","+a+","+i+")");var s=0,r=0,l=0,c=a/e,d=c,u=0,h=0,f=m.allowRandom?.33+Math.random():1,g=[];Math.random()>.5;var p=[i,e>1?parseInt(Math.random()*fc.particleTypes,10):i],v=null;for(s=0;e>s;s++){for(g[s]=parseInt(1*(t*(s+1)/e)/e,10)||1,u=h,h=360/g[s],v=p[s%2],r=0;g[s]>r;r++)m.particles[l]=new FireworkParticle(m.o,m.allowRandom,v,n,o,m.obeyBoundaries),m.particles[l].slideTo(d*Math.cos(u*Math.PI/180),d*f*Math.sin(u*Math.PI/180)),u+=h,l++;d+=c}},m.oC.appendChild(m.o),m.moveTo(m.x,m.y),m.createBurst(l,r,s,i),m.slideTo(n,o);var f="fire"+parseInt(2*Math.random(),10);soundManager.ok()&&soundManager.play(f,{pan:fc.getPanX(m.x)}),fc.animator.start()}function FireworkParticle(e,t,a,n,o,i){var s=this;this.oC=e,this.oID="fp"+fc.gOID++,this.o=fc.oFP.cloneNode(!0),this.obeyBoundaries=i,this.type=null,this.oImg=this.o.getElementsByTagName("img")[0],this.oImg._src=this.oImg.src,this.o.style.display="none",this.baseX=n,this.baseY=o,this.x=0,this.y=0,this.vx=0,this.vy=0,this.frame=0,this.tween=[],this.active=null,this.tweenType="blast",this.states=[],this.state=parseInt(3*Math.random(),10),this.isRandom=t,this._mt=5,this.moveTo=function(e,t){s.o.style.left=e+"px",s.o.style.top=t+"px",s.vx=e-s.x,s.vy=t-s.y,s.x=e,s.y=t},this.moveRel=function(){var e=s.x+s.vx,t=s.y+s.vy;if(s.obeyBoundaries){var a=fc.canvasX-s.baseX-fc.particleXY,n=fc.canvasY-s.baseY-fc.particleXY,o=fc.scrollY;s.vx>=0?e>=a&&(s.vx*=-1):0>s.vx&&0>=e+s.baseX&&(s.vx*=-1),s.vy>=0?t>=n&&(s.vy*=-1):0>s.vy&&0>=t+s.baseY-o&&(s.vy*=-1)}s.moveTo(s.x+s.vx,s.y+s.vy)},this.setOpacity=function(e){s.oImg.style.marginLeft=-100+e*fc.particleXY/10+"px"},this.nextState=function(){var e=s.o.style.visibility;2===s.state&&"hidden"!==e?s.o.style.visibility="hidden":2!==s.state&&"hidden"===e&&(s.o.style.visibility="visible"),s.state=parseInt(3*Math.random(),10)},this.slideTo=function(e,t){s.isRandom&&(e+=.2*e*(Math.random()>.5?1:-1),t+=.2*t*(Math.random()>.5?1:-1)),s.tween=[fc.animator.createTween(s.x,e,s.tweenType),fc.animator.createTween(s.y,t,s.tweenType)];var a=fc.canvasX-fc.particleXY,n=fc.canvasY-fc.particleXY;fc.particleXY-s.baseX;var o=fc.scrollY,i=null,r=null;if(s.obeyBoundaries)for(var l=s.tween[0].length;l--;)i=s.tween[0][l].data+s.baseX,r=s.tween[1][l].data+s.baseY,i>=a?s.tween[0][l].data-=2*(i-a):0>i&&(s.tween[0][l].data-=2*i),r>=n?s.tween[1][l].data-=2*(r-n):0>=r-o&&(s.tween[1][l].data-=2*(r-o))},this.animate=function(){var e=s.tween[0][s.frame].data,t=s.tween[1][s.frame].data;return s.moveTo(e,t),s.frame++>=s.tween[0].length-1?(s._oncomplete&&s._oncomplete(),s._oncomplete=null,s.active=!1,s.frame=0,!1):(s.frame>10&&s.nextState(),!0)},this.destructor=function(){s.oImg=null,s.oC.removeChild(s.o),s.oC=null,s.o=null},this.setType=function(e){s.type=e,s.oImg.style.marginTop=-(fc.particleXY*e)+"px"},s.setType(a),s.oC.appendChild(s.o)}function createFirework(e,t,a,n,o,i,s,r,l,c){var d="";for(var m in arguments)arguments.hasOwnProperty(m)&&(d+=m+",");writeDebug("createFirework("+d+")"),o=fc.isEmpty(o)?parseInt(Math.random()*fc.canvasX,10):parseInt(fc.canvasX*o/100,10),i=fc.isEmpty(i)?fc.canvasY-fc.particleXY:fc.canvasY-fc.screenY+parseInt(fc.screenY*i/100,10),s=fc.isEmpty(s)?parseInt(.1*fc.canvasX+.8*Math.random()*fc.canvasX,10):parseInt(fc.canvasX*s/100,10),r=fc.isEmpty(r)?fc.canvasY-parseInt(Math.random()*fc.screenY,10):fc.canvasY-parseInt(fc.screenY*(100-r)/100,10),fc.isEmpty(n)&&(n=parseInt(Math.random()*fc.particleTypes,10)),e=fc.isEmpty(e)?64+parseInt(.75*Math.random()*fc.screenY,10):(""+e).indexOf("%")>=0?parseInt(parseInt(e,10)/100*fc.screenY,10):(""+e).indexOf(".")>=0?parseInt(e*fc.screenY,10):parseInt(e*fc.screenY/100,10),fc.isEmpty(t)&&(t=4+parseInt(64*Math.random(),10)),fc.isEmpty(a)&&(a=Math.random()>.5?2:1),fc.isEmpty(l)&&(l=Math.random()>.5),fc.isEmpty(c)&&(c=Math.random()>.5),fc.getWindowCoords(),fc.fireworks[fc.fireworks.length]=new Firework(document.getElementById("fireContainer"),o,i,s,r,n,e,t,a,l,c)}function addEventHandler(e,t,a){return"undefined"==typeof attachEvent?e.addEventListener(t,a,!1):e.attachEvent("on"+t,a)}function removeEventHandler(e,t,a){return"undefined"==typeof attachEvent?e.removeEventListener(t,a,!1):e.detachEvent("on"+t,a)}function NextLevel(){Pause(!1),document.getElementsByClassName("LvlComplete")[0].style.display="none"}function getMousePos(e,t){var a=e.getBoundingClientRect();return{x:t.clientX-a.left,y:t.clientY-a.top}}function mouseClick(e){e.preventDefault(),player.shot||(player.shoot(),setTimeout(function(){player.shot=!1},500),player.shot=!0)}function Enemy(e){return e=e||{},e.active=!0,e.age=Math.floor(128*Math.random()),e.x=Math.random()*canvas.width,e.y=0,e.xVelocity=0,e.yVelocity=.5,e.width=42,e.height=37,e.length=0,e.frame=void 0,e.index=0,e.elapsed=0,e.snd=new Audio(SoundTest?"http://fassetar.github.io/penguins-rising/content/audio/mp3/cry.mp3":"content/wav/cry.wav"),e.animation=new AnimationData([{x:40,length:180},{x:78,length:180},{x:127,length:180}],{repeats:!0,keyframe:0}),e.reset=function(){e.elapsed=0,e.index=0,e.frame=e.animation.frames[e.index]}(),e.length=e.animation.frames.length,e.inBounds=function(){return e.y!==canvas.height?e.x>=0&&e.x<=canvas.width&&e.y>=0&&e.y<=canvas.height:(player.health-=1,!1)},e.RnP=Math.floor(3*Math.random()),e.deadAnm=[169,204,250],e.draw=function(){e.active?ctx.drawImage(img,e.frame.x,0,e.width,e.height,e.x,e.y,e.width,e.height):ctx.drawImage(img,e.deadAnm[e.RnP],0,45,37,e.x,e.y,46,37)},e.update=function(){e.active&&(e.x+=e.xVelocity,e.y+=e.yVelocity,e.xVelocity=Math.sin(e.age*Math.PI/64),e.age++,e.active=e.active&&e.inBounds(),e.elapsed=e.elapsed+30,e.elapsed>=e.frame.length&&(e.index++,e.elapsed=e.elapsed-e.frame.length),this.index>=this.length&&(this.animation.options.repeats?this.index=this.animation.options.keyframe:this.index--),e.frame=e.animation.frames[e.index])},e.deactive=function(){e.active=!1},e}function Boss(){}function Bullet(e){return e.type=0,e.active=!0,e.speed=10,e.radian=Math.atan2(canvas.width/2-game.mousePos.x,canvas.height-60-game.mousePos.y),e.xVelocity=-e.speed*Math.sin(e.radian),e.yVelocity=-e.speed*Math.cos(e.radian),e.width=3,e.height=3,e.color="#000",e.inBounds=function(){return e.x>=0&&e.x<=canvas.width&&e.y>=0&&e.y<=canvas.height},e.draw=function(){ctx.fillStyle=e.color,ctx.fillRect(e.x,e.y,e.width,e.height)},e.update=function(){e.x+=e.xVelocity,e.y+=e.yVelocity,e.active=e.active&&e.inBounds()},e}function AnimationData(e,t){this.frames=e||[{x:0,y:0,w:0,h:0,length:0}],this.options=t||{repeats:!1,keyframe:0}}function draw(){ctx.clearRect(0,0,canvas.width,canvas.height),ctx.drawImage(border,23,canvas.height-150,canvas.width-45,100),player.draw(),TheTrulyDead.forEach(function(e){e.draw()}),player.Bullets.forEach(function(e){e.draw()}),enemies.forEach(function(e){e.draw()}),ctx.fillText("Kills:"+TheTrulyDead.length,10,50),ctx.fillText("Level:"+game.Lvl,10,70),ctx.fillText("Health:"+player.health,10,100)}function collides(e,t){return e.x<t.x+t.width&&e.x+e.width>t.x&&e.y<t.y+t.height&&e.y+e.height>t.y}function handleCollisions(){player.Bullets.forEach(function(e){enemies.forEach(function(t){collides(e,t)&&(t.deactive(),TheTrulyDead.push(t),t.snd.play(),e.active=!1)})})}var achManager=achManager||{};achManager.achievements={},achManager.preloaded=!1,achManager.loadData=function(){var e=gapi.client.games.achievementDefinitions.list();e.execute(function(e){if(console.log("Achievement definitions",e),"games#achievementDefinitionsListResponse"===e.kind&&e.hasOwnProperty("items")){for(var t=0;e.items.length>t;t++)achManager.achievements[e.items[t].id]=e.items[t],achManager.achievements[e.items[t].id].achievementState=e.items[t].initialState;welcome.dataLoaded(welcome.ENUM_ACHIEVEMENT_DEFS),achManager.loadAchievementsEarnedByPlayer()}})},achManager.loadAchievementsEarnedByPlayer=function(){var e=gapi.client.games.achievements.list({playerId:"me"});e.execute(function(e){if(console.log("Your achievement data: ",e),"games#playerAchievementListResponse"===e.kind&&e.hasOwnProperty("items")){for(var t=0;e.items.length>t;t++){var a=e.items[t];achManager.achievements[a.id].achievementState=a.achievementState,a.hasOwnProperty("formattedCurrentStepsString")&&(achManager.achievements[a.id].formattedCurrentStepsString=a.formattedCurrentStepsString)}welcome.dataLoaded(welcome.ENUM_ACHIEVEMENT_PROGRESS)}else console.log("**Unexpected response **",e)}),achManager.preloaded=!0},achManager.scoreRequested=function(e){0===e?achManager.unlockAchievement(constants.ACH_HUMBLE):9999===e&&achManager.unlockAchievement(constants.ACH_COCKY)},achManager.scoreReturned=function(e){1337===e?achManager.unlockAchievement(constants.ACH_LEET):e>1&&utils.isPrime(e)&&achManager.unlockAchievement(constants.ACH_PRIME),achManager.submitProgress(constants.ACH_BORED,1),achManager.submitProgress(constants.ACH_REALLY_BORED,1)},achManager.getNameForId=function(e){return achManager.achievements[e].name},achManager.submitProgress=function(e,t){var a=gapi.client.games.achievements.increment({achievementId:e,stepsToIncrement:t});a.execute(function(t){console.log("Data from incrementing achievement is ",t),achManager.achievements[e].currentSteps=t.currentSteps,achManager.achievements[e].formattedCurrentStepsString=t.currentSteps+"",t.newlyUnlocked?achievementWidget.showAchievementWidget(e):console.log("You either haven't unlocked "+achManager.achievements[e].name+" yet, or you unlocked it already.")})},achManager.unlockAchievement=function(e){var t=gapi.client.games.achievements.unlock({achievementId:e});t.execute(function(t){console.log("Data from earning achievement is ",t),t.newlyUnlocked?(achievementWidget.showAchievementWidget(e),achManager.loadAchievementsEarnedByPlayer()):console.log("You unlocked "+achManager.achievements[e].name+" but you already unlocked it earlier.")})};var achievementTable=achievementTable||{};achievementTable.loadUp=function(){achievementTable.clearOut(),achManager.preloaded&&$.each(achManager.achievements,function(e,t){var a=achievementTable.buildTableRowFromData(t);a.appendTo($("#achievementsTable tbody"))}),$("#achievements").fadeIn(),$("#pageHeader").text("Achievements")},achievementTable.buildTableRowFromData=function(e){var t=$("<tr></tr>"),a=$("<td></td>").text(e.name).addClass("achievementName"),n=$("<td></td>").text(e.description).addClass("achievementDescrip"),o="";if("REVEALED"===e.achievementState){if(o=e.revealedIconUrl,"INCREMENTAL"===e.achievementType&&e.hasOwnProperty("formattedCurrentStepsString")){var i="("+e.formattedCurrentStepsString+"/"+e.formattedTotalSteps+")",s=$("<div></div>").text(i);n.append(s)}}else"UNLOCKED"===e.achievementState?o=e.unlockedIconUrl:"HIDDEN"===e.achievementState&&(o="images/Question_mark.png",a.text("Hidden"),n.text("This mysterious achievement will be revealed later"));var r=$("<img />").attr("src",o).attr("alt",e.achievementState).addClass("medIcon").appendTo($("<td></td>"));return t.append(a).append(n).append(r),t},achievementTable.goBack=function(){$("#achievements").fadeOut(),welcome.loadUp()},achievementTable.clearOut=function(){$("#achievementsTable tbody").html("")};var achievementWidget=achievementWidget||{};achievementWidget.showAchievementWidget=function(e){var t=$("#achUnlocked");t.find("img").prop("src",achManager.achievements[e].unlockedIconUrl),t.find("#achName").text(achManager.achievements[e].name),t.find("#achDescrip").text(achManager.achievements[e].description),t.css({top:"300px",opacity:"1.0"}),t.show(),t.delay(2e3).animate({top:50,opacity:.1},500,function(){t.hide()})},function(){"use strict";function e(){this.successCount=0,this.errorCount=0,this.downloadQueue=[],this.cache={}}e.prototype.queueDownload=function(e){this.downloadQueue.push(e)},e.prototype.downloadAll=function(e){0===this.downloadQueue.length&&e();for(var t=0;this.downloadQueue.length>t;t++){var a=this.downloadQueue[t],n=new Image;n.src=a,this.cache[a]=n}},e.prototype.isDone=function(){return this.downloadQueue.length===this.successCount+this.errorCount},e.prototype.getAsset=function(e){return this.cache[e]};var t=new e;t.downloadAll(function(){}),t.isDone&&(document.getElementById("Gamer").innerHTML="Play"),function(e,t,a,n,o,i,s){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(a),s=t.getElementsByTagName(a)[0],i.async=1,i.src=n,s.parentNode.insertBefore(i,s)}(window,document,"script","//www.google-analytics.com/analytics.js","ga"),ga("create","UA-41648493-1","penguinsontherise.appspot.com"),ga("send","pageview"),window.addEventListener("error",function(e){ga("send","event","Javascript Error",e.filename+":  "+e.lineno,e.message)})}();var fc;soundManager.url="./swf/",soundManager.useHighPerformance=!0,soundManager.useHTML5Audio=!0,soundManager.wmode="transparent",soundManager.onready(function(){var e={fire0:"boom3.mp3",fire1:"boom4.mp3",boom0:"boom1.mp3",boom1:"boom2.mp3",boom2:"pop1.mp3",boom3:"pop2.mp3",boom4:"pop3.mp3",boom5:"pop4.mp3",boom6:"pop5.mp3",boom7:"pop6.mp3"};for(var t in e)e.hasOwnProperty(t)&&soundManager.createSound({id:t,url:"audio/"+e[t],autoLoad:!0})}),fc=new FireworksController,"undefined"==typeof writeDebug&&(window.writeDebug=function(){return!1}),addEventHandler(window,"resize",fc.getWindowCoords),addEventHandler(window,"scroll",fc.getWindowCoords),addEventHandler(window,"load",fc.init),addEventHandler(window,"unload",fc.destructor);var img=new Image;img.src="http://fassetar.github.io/penguins-rising/content/img/characters.png";var canvas=document.getElementById("window"),ctx=canvas.getContext("2d"),enemies=[],TheTrulyDead=[],bosses=[],game={paused:!1,timer:null,Lvl:1,Lvlcomplete:!1,LvlEnemies:3,mousePos:{x:0,y:0},loop:function(){if(game.over||game.paused){if(game.over){var e=confirm("Your lose! Start Over?");e&&location.reload()}}else game.update(),draw();requestAnimFrame(game.loop)},over:!1,startGame:function(){canvas.addEventListener("mousedown",mouseClick),window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){window.setTimeout(e,50)}}(),game.loop(),window.onblur=function(){Pause(!0)},document.onkeypress=function(e){e=e||window.event;var t=e.keyCode||e.which,a=String.fromCharCode(t);"p"===a&&Pause()}},update:function(){TheTrulyDead.length>game.LvlEnemies&&0===enemies.length&&(game.Lvlcomplete=!0,game.LvlEnemies+=5,game.Lvl+=1,player.health=10),canvas.height="innerHeight"in window?window.innerHeight:document.documentElement.offsetHeight,canvas.width="innerWidth"in window?window.innerWidth:document.documentElement.offsetWidth,0>=player.health&&(game.over=!0),!game.Lvlcomplete&&player.update?(player.Bullets.forEach(function(e){e.update()}),player.Bullets=player.Bullets.filter(function(e){return e.active}),enemies.forEach(function(e){e.update()}),enemies=enemies.filter(function(e){return e.active}),handleCollisions(),game.LvlEnemies>enemies.length&&TheTrulyDead.length<=game.LvlEnemies&&(enemies.push(Enemy()),bosses.push(Boss(this)))):(player.update||console.log("you died"),enemies=[],TheTrulyDead=[],bosses=[],game.Lvlcomplete=!1,document.getElementsByClassName("LvlComplete")[0].style.display="block",game.paused=!0)}},Pause=function(e){game.paused=e?e:!game.paused,document.getElementsByClassName("pause")[0].style.display=game.paused?"block":"none"};window.onresize=function(){canvas.height="innerHeight"in window?window.innerHeight:document.documentElement.offsetHeight,canvas.width="innerWidth"in window?window.innerWidth:document.documentElement.offsetWidth}(),canvas.addEventListener("mousemove",function(e){game.mousePos=getMousePos(canvas,e)},!1);var a=document.createElement("audio"),SoundTest=function(){return!(!a.createElement("audio").canPlayType||!a.canPlayType("audio/mpeg;").replace(/no/,""))},player={x:canvas.width/2,y:canvas.height-60,vx:0,vy:0,health:10,Bullets:[],active:!0,weapons:{selected:[0,0,0],choice:["Uzi","Hunting Rifle","Shotgun","Minigun"],secondary:["Grenade","Mine","Ice Cracker","Reaper"],support:["Upgrade Wall","Barbes Wire","Eskimo Guards","Polar Bear","Mortar Support"]},draw:function(){ctx.save(),ctx.translate(canvas.width/2,canvas.height-60),ctx.rotate(Math.atan2(game.mousePos.x-canvas.width/2,canvas.height-60-game.mousePos.y)),ctx.drawImage(img,0,0,42,59,-18,-33,42,59),ctx.restore()},update:function(){return 1>player.health?!1:!0},shot:!1,snd:new Audio(SoundTest?"http://fassetar.github.io/penguins-rising/content/audio/mp3/gunshot.mp3":"http://fassetar.github.io/penguins-rising/content/audio/wav/gunshot.wav"),shoot:function(){var e=Math.atan2(canvas.width/2-game.mousePos.x,canvas.height-60-game.mousePos.y);player.snd.play(),player.Bullets.push(Bullet({radian:e,x:canvas.width/2+-18*Math.sin(e),y:canvas.height-60+-18*Math.cos(e)}))},displayName:"anonymous",profileUrl:"",userId:"",loadLocalPlayer:function(){var e=gapi.client.games.players.get({playerId:"me"});e.execute(function(e){e.displayName||(e.displayName="anonymous"),$("#welcome #message").text("Welcome, "+e.displayName+"!"),$("#welcomeAchievements, #welcomeleaderboards").fadeIn(),player.displayName=e.displayName,player.profileUrl=e.avatarImageUrl,player.userId=e.playerId,welcome.dataLoaded(welcome.ENUM_PLAYER_DATA)})}};Boss.prototype=new Enemy;var border=new Image;border.src="https://raw.githubusercontent.com/fassetar/penguins-rising/master/src/content/img/borderline.jpg";var leadManager=leadManager||{};leadManager.preloaded=!1,leadManager.leaderboards={},leadManager.preloadData=function(){var e=gapi.client.games.leaderboards.list();e.execute(function(e){if(console.log("Leaderboard data",e),"games#leaderboardListResponse"===e.kind&&e.hasOwnProperty("items"))for(var t=0;e.items.length>t;t++)leadManager.leaderboards[e.items[t].id]=e.items[t];leadManager.preloaded=!0,welcome.dataLoaded(welcome.ENUM_LEADERBOARDS)})},leadManager.getLeaderboardObject=function(e){return leadManager.leaderboards[e]},leadManager.gotScore=function(e,t,a){var n=t===game.EASY?constants.LEADERBOARD_EASY:constants.LEADERBOARD_HARD,o=gapi.client.games.scores.submit({leaderboardId:n,score:e});o.execute(function(e){console.log("Data from submitting high score is ",e);var t=!1;if(e.hasOwnProperty("beatenScoreTimeSpans"))for(var o=0;e.beatenScoreTimeSpans.length>o;o++)"WEEKLY"===e.beatenScoreTimeSpans[o]&&(console.log("Hooray! New weekly high score!"),t=!0,leaderboardWidget.show(n));a(t)})};var leaderboardWidget=leaderboardWidget||{};leaderboardWidget.show=function(e){var t=leadManager.getLeaderboardObject(e),a=t.iconUrl?t.iconUrl:"img/genericLeaderboard.png";$("#leadUnlocked img").prop("src",a),$("#leadUnlocked #leadName").text(t.name),$("#leadUnlocked").css({top:"250px",opacity:"1.0"}),$("#leadUnlocked").show(),$("#leadUnlocked").delay(3e3).animate({top:"50px",opacity:.1},500,function(){$("#leadUnlocked").hide()})};var leaderboardsTable=leaderboardsTable||{};leaderboardsTable.showAllLeaderboards=function(){leaderboardsTable.clearOut(),leadManager.preloaded&&($.each(leadManager.leaderboards,function(e,t){var a=leaderboardsTable.buildLeaderboardsRowFromData(t);a.appendTo($("#leaderboardsTable tbody"))}),$("#leaderboards").fadeIn()),$("#pageHeader").text("Leaderboards")},leaderboardsTable.buildLeaderboardsRowFromData=function(e){var t=$("<tr></tr>"),a=e.iconUrl?e.iconUrl:"img/genericLeaderboard.png",n=$("<td></td>").append($("<img />").prop("src",a).addClass("medIcon")),o=$("<td></td>").text(e.name),i=$("<td></td>").append($('<input type="button" />').prop("value","View").click(function(){leaderboardsTable.selectLeaderboard(e.id)}));return t.append(n).append(o).append(i),t},leaderboardsTable.selectLeaderboard=function(e){$("#leaderboards").hide(),leaderboardTable.showLeaderboard(e,leaderboardTable.BACK_TO_ALL_LEADERBOARDS)},leaderboardsTable.clearOut=function(){$("#leaderboardsTable tbody").html("")},leaderboardsTable.goBack=function(){$("#leaderboards").fadeOut(),welcome.loadUp()};var constants=constants||{};constants.CLIENT_ID="926286388840-qbj01r8d9on9dvnnba1m8iiknrtulrb1.apps.googleusercontent.com",constants.ACH_DONT_GET_COCKY_KID="CgkInoXkzIgWEAIQCA",constants.ACH_WERE_ALL_OUT_OF_BUBBLEGUM="CgkInoXkzIgWEAIQCw",constants.ACH_PRIME_TIME_FOR_YOUR_LIFE="CgkInoXkzIgWEAIQLg",constants.ACH_THE_PRINCESS_IS_BACK="CgkInoXkzIgWEAIQEg",constants.ACH_GOT_LUCKY="CgkInoXkzIgWEAIQDg",constants.ACH_A_TASTE_FOR_BLOOD="CgkInoXkzIgWEAIQDw",constants.ACH_KICKIN_IT_OLD_SKOOL="CgkInoXkzIgWEAIQDQ",constants.ACH_A_HIGHER_FOOD_CHAIN="CgkInoXkzIgWEAIQBw",constants.ACH_DONT_FEAR_THE_REPEAR="CgkInoXkzIgWEAIQKA",constants.ACH_THE_MOTHER_LOAD_OF_COWS="CgkInoXkzIgWEAIQEw",constants.ACH_ZOMBIE_PENGUIN_TRAINEE="CgkInoXkzIgWEAIQKQ",constants.ACH_ZOMBIE_PENGUIN_ADAPT="CgkInoXkzIgWEAIQBg",constants.ACH_ZOMBIE_PENGUIN_EXCEPT="CgkInoXkzIgWEAIQEQ",constants.ACH_ZOMBIE_PENGUIN_MASTER="CgkInoXkzIgWEAIQDA",constants.ACH_THERES_CAKE_AND_ICE_CREAM="CgkInoXkzIgWEAIQLA",constants.LEAD_HIGH_SCORES="CgkInoXkzIgWEAIQBQ",constants.LEAD_LONGEST_LIVED="CgkInoXkzIgWEAIQKg";var login={userId:"",loggedIn:!1,scopes:"https://www.googleapis.com/auth/games",init:function(){window.setTimeout(login.trySilentAuth,1)},loadClient:function(){gapi.client.load("games","v1",function(){achManager.loadData(),leadManager.preloadData(),welcome.loadUp(),$("#BetaInfo").hide()}),gapi.client.load("gamesManagement","v1management",function(){welcome.dataLoaded(welcome.ENUM_MANAGEMENT_API)}),gapi.client.load("plus","v1",function(){welcome.dataLoaded(welcome.ENUM_PLUS_API)})}};login.handleAuthResult=function(e){console.log("We are in handle auth result");var t=document.createElement("SCRIPT");t.src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js",t.type="text/javascript",document.getElementsByTagName("head")[0].appendChild(t),checkReady(function(t){e?(t("#loginDiv").fadeOut(),login.loadClient()):t("#loginDiv").fadeIn()})};var checkReady=function(e){window.jQuery?e(jQuery):window.setTimeout(function(){checkReady(e)},100)};login.trySilentAuth=function(){gapi.auth.authorize({client_id:constants.CLIENT_ID,scope:login.scopes,immediate:!0},login.handleAuthResult)},login.showLoginDialog=function(){gapi.auth.authorize({client_id:constants.CLIENT_ID,scope:login.scopes,immediate:!1},login.handleAuthResult)};var welcome=welcome||{};welcome.leaderboards_loaded=!1,welcome.achievement_defs_loaded=!1,welcome.achievement_progress_loaded=!1,welcome.player_data_loaded=!1,welcome.challenge_loaded=!1,welcome.management_APIs_loaded=!1,welcome.plus_APIs_loaded=!1,welcome.ENUM_LEADERBOARDS=1,welcome.ENUM_ACHIEVEMENT_DEFS=2,welcome.ENUM_ACHIEVEMENT_PROGRESS=3,welcome.ENUM_PLAYER_DATA=4,welcome.ENUM_CHALLENGE_DATA=5,welcome.ENUM_MANAGEMENT_API=6,welcome.ENUM_PLUS_API=7,welcome.dataLoaded=function(e){e===welcome.ENUM_LEADERBOARDS?welcome.leaderboards_loaded=!0:e===welcome.ENUM_ACHIEVEMENT_DEFS?welcome.achievement_defs_loaded=!0:e===welcome.ENUM_ACHIEVEMENT_PROGRESS?welcome.achievement_progress_loaded=!0:e===welcome.ENUM_PLAYER_DATA?welcome.player_data_loaded=!0:e===welcome.ENUM_CHALLENGE_DATA?welcome.challenge_loaded=!0:e===welcome.ENUM_MANAGEMENT_API?welcome.management_APIs_loaded=!0:e===welcome.ENUM_PLUS_API&&(welcome.plus_APIs_loaded=!0),welcome.activateButtonsIfReady()},welcome.activateButtonsIfReady=function(){welcome.leaderboards_loaded&&welcome.achievement_defs_loaded&&welcome.achievement_progress_loaded&&welcome.player_data_loaded&&welcome.challenge_loaded&&welcome.management_APIs_loaded&&welcome.plus_APIs_loaded&&($("#welcome input").attr("disabled",!1),$("#game").show(),welcome.startGame())},welcome.loadUp=function(){$("#welcome").fadeIn()},welcome.showCredits=function(e,t){var a=document.getElementById(e);a.style.display="none"!==a.style.display?"none":"",document.getElementById(t).style.display="block"===document.getElementById(t).style.display?"none":"block"},welcome.showAchievements=function(){achievementTable.loadUp()},welcome.showLeaderboards=function(){leaderboardsTable.showAllLeaderboards()},welcome.startGame=function(){document.getElementById("dialog-modal").style.display="none",document.getElementById("game").style.display="block",game.startGame()};var snowStorm=function(e,t){function a(e,t){return isNaN(t)&&(t=0),Math.random()*e+t}function n(e){return 1===parseInt(a(2),10)?-1*e:e}function o(){e.setTimeout(function(){r.start(!0)},20),r.events.remove(l?t:e,"mousemove",o)}function i(){r.excludeMobile&&d||o(),r.events.remove(e,"load",i)}this.autoStart=!0,this.excludeMobile=!0,this.flakesMax=128,this.flakesMaxActive=64,this.animationInterval=33,this.useGPU=!0,this.className=null,this.excludeMobile=!0,this.flakeBottom=null,this.followMouse=!0,this.snowColor="#fff",this.snowCharacter="&bull;",this.snowStick=!0,this.targetElement=null,this.useMeltEffect=!0,this.useTwinkleEffect=!1,this.usePositionFixed=!1,this.usePixelPosition=!1,this.freezeOnBlur=!0,this.flakeLeftOffset=0,this.flakeRightOffset=0,this.flakeWidth=8,this.flakeHeight=8,this.vMaxX=5,this.vMaxY=4,this.zIndex=0;var s,r=this,l=navigator.userAgent.match(/msie/i),c=navigator.userAgent.match(/msie 6/i),d=navigator.userAgent.match(/mobile|opera m(ob|in)/i),m=l&&"BackCompat"===t.compatMode,u=m||c,h=null,f=null,g=null,p=null,v=null,y=null,w=null,E=1,b=2,I=6,k=!1,A=!1,M=function(){try{t.createElement("div").style.opacity="0.5"}catch(e){return!1}return!0}(),x=!1,_=t.createDocumentFragment();return s=function(){function a(t){e.setTimeout(t,1e3/(r.animationInterval||20))}function n(e){var t=s.style[e];return void 0!==t?e:null}var o,i=e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||e.oRequestAnimationFrame||e.msRequestAnimationFrame||a;o=i?function(){return i.apply(e,arguments)}:null;var s;s=t.createElement("div");var l={transform:{ie:n("-ms-transform"),moz:n("MozTransform"),opera:n("OTransform"),webkit:n("webkitTransform"),w3:n("transform"),prop:null},getAnimationFrame:o};return l.transform.prop=l.transform.w3||l.transform.moz||l.transform.webkit||l.transform.ie||l.transform.opera,s=null,l}(),this.timer=null,this.flakes=[],this.disabled=!1,this.active=!1,this.meltFrameCount=20,this.meltFrames=[],this.setXY=function(e,t,a){return e?(r.usePixelPosition||A?(e.style.left=t-r.flakeWidth+"px",e.style.top=a-r.flakeHeight+"px"):u?(e.style.right=100-100*(t/h)+"%",e.style.top=Math.min(a,v-r.flakeHeight)+"px"):r.flakeBottom?(e.style.right=100-100*(t/h)+"%",e.style.top=Math.min(a,v-r.flakeHeight)+"px"):(e.style.right=100-100*(t/h)+"%",e.style.bottom=100-100*(a/g)+"%"),void 0):!1},this.events=function(){function t(e){var t=s.call(e),a=t.length;return i?(t[1]="on"+t[1],a>3&&t.pop()):3===a&&t.push(!1),t}function a(e,t){var a=e.shift(),n=[r[t]];i?a[n](e[0],e[1]):a[n].apply(a,e)}function n(){a(t(arguments),"add")}function o(){a(t(arguments),"remove")}var i=!e.addEventListener&&e.attachEvent,s=Array.prototype.slice,r={add:i?"attachEvent":"addEventListener",remove:i?"detachEvent":"removeEventListener"};return{add:n,remove:o}}(),this.randomizeWind=function(){var e;if(y=n(a(r.vMaxX,.2)),w=a(r.vMaxY,.2),this.flakes)for(e=0;this.flakes.length>e;e++)this.flakes[e].active&&this.flakes[e].setVelocities()},this.scrollHandler=function(){var a;if(p=r.flakeBottom?0:parseInt(e.scrollY||t.documentElement.scrollTop||(u?t.body.scrollTop:0),10),isNaN(p)&&(p=0),!k&&!r.flakeBottom&&r.flakes)for(a=0;r.flakes.length>a;a++)0===r.flakes[a].active&&r.flakes[a].stick()
},this.resizeHandler=function(){e.innerWidth||e.innerHeight?(h=e.innerWidth-16-r.flakeRightOffset,g=r.flakeBottom||e.innerHeight):(h=(t.documentElement.clientWidth||t.body.clientWidth||t.body.scrollWidth)-(l?0:8)-r.flakeRightOffset,g=r.flakeBottom||t.documentElement.clientHeight||t.body.clientHeight||t.body.scrollHeight),v=t.body.offsetHeight,f=parseInt(h/2,10)},this.resizeHandlerAlt=function(){h=r.targetElement.offsetWidth-r.flakeRightOffset,g=r.flakeBottom||r.targetElement.offsetHeight,f=parseInt(h/2,10),v=t.body.offsetHeight},this.freeze=function(){return r.disabled?!1:(r.disabled=1,r.timer=null,void 0)},this.resume=function(){return r.disabled?(r.disabled=0,r.timerInit(),void 0):!1},this.toggleSnow=function(){r.flakes.length?(r.active=!r.active,r.active?(r.show(),r.resume()):(r.stop(),r.freeze())):r.start()},this.stop=function(){var a;for(this.freeze(),a=0;this.flakes.length>a;a++)this.flakes[a].o.style.display="none";r.events.remove(e,"scroll",r.scrollHandler),r.events.remove(e,"resize",r.resizeHandler),r.freezeOnBlur&&(l?(r.events.remove(t,"focusout",r.freeze),r.events.remove(t,"focusin",r.resume)):(r.events.remove(e,"blur",r.freeze),r.events.remove(e,"focus",r.resume)))},this.show=function(){var e;for(e=0;this.flakes.length>e;e++)this.flakes[e].o.style.display="block"},this.SnowFlake=function(e,n,o){var i=this;this.type=e,this.x=n||parseInt(a(h-20),10),this.y=isNaN(o)?-a(g)-12:o,this.vX=null,this.vY=null,this.vAmpTypes=[1,1.2,1.4,1.6,1.8],this.vAmp=this.vAmpTypes[this.type]||1,this.melting=!1,this.meltFrameCount=r.meltFrameCount,this.meltFrames=r.meltFrames,this.meltFrame=0,this.twinkleFrame=0,this.active=1,this.fontSize=10+10*(this.type/5),this.o=t.createElement("div"),this.o.innerHTML=r.snowCharacter,r.className&&this.o.setAttribute("class",r.className),this.o.style.color=r.snowColor,this.o.style.position=k?"fixed":"absolute",r.useGPU&&s.transform.prop&&(this.o.style[s.transform.prop]="translate3d(0px, 0px, 0px)"),this.o.style.width=r.flakeWidth+"px",this.o.style.height=r.flakeHeight+"px",this.o.style.fontFamily="arial,verdana",this.o.style.cursor="default",this.o.style.overflow="hidden",this.o.style.fontWeight="normal",this.o.style.zIndex=r.zIndex,_.appendChild(this.o),this.refresh=function(){return isNaN(i.x)||isNaN(i.y)?!1:(r.setXY(i.o,i.x,i.y),void 0)},this.stick=function(){u||r.targetElement!==t.documentElement&&r.targetElement!==t.body?i.o.style.top=g+p-r.flakeHeight+"px":r.flakeBottom?i.o.style.top=r.flakeBottom+"px":(i.o.style.display="none",i.o.style.bottom="0%",i.o.style.position="fixed",i.o.style.display="block")},this.vCheck=function(){i.vX>=0&&.2>i.vX?i.vX=.2:0>i.vX&&i.vX>-.2&&(i.vX=-.2),i.vY>=0&&.2>i.vY&&(i.vY=.2)},this.move=function(){var e,t=i.vX*E;i.x+=t,i.y+=i.vY*i.vAmp,i.x>=h||h-i.x<r.flakeWidth?i.x=0:0>t&&i.x-r.flakeLeftOffset<-r.flakeWidth&&(i.x=h-r.flakeWidth-1),i.refresh(),e=g+p-i.y+r.flakeHeight,r.flakeHeight>e?(i.active=0,r.snowStick?i.stick():i.recycle()):(r.useMeltEffect&&i.active&&3>i.type&&!i.melting&&Math.random()>.998&&(i.melting=!0,i.melt()),r.useTwinkleEffect&&(0>i.twinkleFrame?Math.random()>.97&&(i.twinkleFrame=parseInt(8*Math.random(),10)):(i.twinkleFrame--,M?i.o.style.opacity=i.twinkleFrame&&0===i.twinkleFrame%2?0:1:i.o.style.visibility=i.twinkleFrame&&0===i.twinkleFrame%2?"hidden":"visible")))},this.animate=function(){i.move()},this.setVelocities=function(){i.vX=y+a(.12*r.vMaxX,.1),i.vY=w+a(.12*r.vMaxY,.1)},this.setOpacity=function(e,t){return M?(e.style.opacity=t,void 0):!1},this.melt=function(){r.useMeltEffect&&i.melting?i.meltFrame<i.meltFrameCount?(i.setOpacity(i.o,i.meltFrames[i.meltFrame]),i.o.style.fontSize=i.fontSize-i.fontSize*(i.meltFrame/i.meltFrameCount)+"px",i.o.style.lineHeight=r.flakeHeight+2+.75*r.flakeHeight*(i.meltFrame/i.meltFrameCount)+"px",i.meltFrame++):i.recycle():i.recycle()},this.recycle=function(){i.o.style.display="none",i.o.style.position=k?"fixed":"absolute",i.o.style.bottom="auto",i.setVelocities(),i.vCheck(),i.meltFrame=0,i.melting=!1,i.setOpacity(i.o,1),i.o.style.padding="0px",i.o.style.margin="0px",i.o.style.fontSize=i.fontSize+"px",i.o.style.lineHeight=r.flakeHeight+2+"px",i.o.style.textAlign="center",i.o.style.verticalAlign="baseline",i.x=parseInt(a(h-r.flakeWidth-20),10),i.y=parseInt(-1*a(g),10)-r.flakeHeight,i.refresh(),i.o.style.display="block",i.active=1},this.recycle(),this.refresh()},this.snow=function(){var e,t,n=0,o=null;for(e=0,t=r.flakes.length;t>e;e++)1===r.flakes[e].active&&(r.flakes[e].move(),n++),r.flakes[e].melting&&r.flakes[e].melt();r.flakesMaxActive>n&&(o=r.flakes[parseInt(a(r.flakes.length),10)],0===o.active&&(o.melting=!0)),r.timer&&s.getAnimationFrame(r.snow)},this.mouseMove=function(e){if(!r.followMouse)return!0;var t=parseInt(e.clientX,10);f>t?E=-b+t/f*b:(t-=f,E=t/f*b)},this.createSnow=function(e,t){var n;for(n=0;e>n;n++)r.flakes[r.flakes.length]=new r.SnowFlake(parseInt(a(I),10)),(t||n>r.flakesMaxActive)&&(r.flakes[r.flakes.length-1].active=-1);r.targetElement.appendChild(_)},this.timerInit=function(){r.timer=!0,r.snow()},this.init=function(){var a;for(a=0;r.meltFrameCount>a;a++)r.meltFrames.push(1-a/r.meltFrameCount);r.randomizeWind(),r.createSnow(r.flakesMax),r.events.add(e,"resize",r.resizeHandler),r.events.add(e,"scroll",r.scrollHandler),r.freezeOnBlur&&(l?(r.events.add(t,"focusout",r.freeze),r.events.add(t,"focusin",r.resume)):(r.events.add(e,"blur",r.freeze),r.events.add(e,"focus",r.resume))),r.resizeHandler(),r.scrollHandler(),r.followMouse&&r.events.add(l?t:e,"mousemove",r.mouseMove),r.animationInterval=Math.max(20,r.animationInterval),r.timerInit()},this.start=function(a){if(x){if(a)return!0}else x=!0;if("string"==typeof r.targetElement){var n=r.targetElement;if(r.targetElement=t.getElementById(n),!r.targetElement)throw Error('Snowstorm: Unable to get targetElement "'+n+'"')}if(r.targetElement||(r.targetElement=t.body||t.documentElement),r.targetElement!==t.documentElement&&r.targetElement!==t.body&&(r.resizeHandler=r.resizeHandlerAlt,r.usePixelPosition=!0),r.resizeHandler(),r.usePositionFixed=r.usePositionFixed&&!u&&!r.flakeBottom,e.getComputedStyle)try{A="relative"===e.getComputedStyle(r.targetElement,null).getPropertyValue("position")}catch(o){A=!1}k=r.usePositionFixed,h&&g&&!r.disabled&&(r.init(),r.active=!0)},r.autoStart&&r.events.add(e,"load",i,!1),this}(window,document);